<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE QUICKNESS - Performance Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #BF77F6;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 4px solid #BF77F6;
        }
        
        .test-section h2 {
            color: #BF77F6;
            margin-top: 0;
        }
        
        .performance-info {
            background: rgba(16, 185, 129, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .performance-info h3 {
            color: #10b981;
            margin-top: 0;
        }
        
        .test-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .test-link {
            background: rgba(191, 119, 246, 0.2);
            color: #BF77F6;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 8px;
            border: 1px solid rgba(191, 119, 246, 0.3);
            transition: all 0.3s ease;
        }
        
        .test-link:hover {
            background: rgba(191, 119, 246, 0.3);
            transform: translateY(-2px);
        }
        
        .instructions {
            background: rgba(245, 158, 11, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .instructions h3 {
            color: #f59e0b;
            margin-top: 0;
        }
        
        .code-block {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .image-test {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .image-test img {
            max-width: 200px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .console-monitor {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .console-monitor h3 {
            color: #10b981;
            margin-top: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ THE QUICKNESS Performance Test</h1>
        
        <div class="performance-info">
            <h3>‚úÖ Performance Optimizations Applied</h3>
            <ul>
                <li><strong>Lazy Logo Loading:</strong> Logo now loads only when needed for PDF generation</li>
                <li><strong>Reduced Timer Tracking:</strong> Only critical notification timers are tracked</li>
                <li><strong>Memory Optimization:</strong> Limited timer array usage and proper cleanup</li>
                <li><strong>No Auto-Preloading:</strong> Extension no longer fetches logo on page load</li>
                <li><strong>Screenshot Quality:</strong> Optimized to 95% for better performance</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>üéØ Performance Test Instructions</h2>
            <div class="instructions">
                <h3>How to Test:</h3>
                <ol>
                    <li><strong>Open Developer Console</strong> (F12) to monitor performance</li>
                    <li><strong>Click the THE QUICKNESS extension icon</strong> in the browser toolbar</li>
                    <li><strong>Verify no automatic logo fetching</strong> messages in console on page load</li>
                    <li><strong>Test modal responsiveness</strong> - should open instantly</li>
                    <li><strong>Test PDF generation</strong> - logo should load only during PDF creation</li>
                </ol>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîç What to Look For</h2>
            <div class="performance-info">
                <h3>‚úÖ Good Performance Indicators:</h3>
                <ul>
                    <li>No "Fetching logo from external URL" messages on page load</li>
                    <li>Extension icon click responds immediately (no lag)</li>
                    <li>Modal opens quickly with purple background</li>
                    <li>Screenshot preview loads without delay</li>
                    <li>Notes input is responsive</li>
                    <li>Logo loads only when "Save PDF" is clicked</li>
                </ul>
            </div>
            
            <div class="instructions">
                <h3>‚ùå Performance Issues to Watch For:</h3>
                <ul>
                    <li>Automatic logo fetching on page load</li>
                    <li>Delayed extension icon response</li>
                    <li>Slow modal opening</li>
                    <li>Excessive console logging</li>
                    <li>Memory pressure warnings</li>
                </ul>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üñºÔ∏è Test Content for Screenshots</h2>
            <p>This page contains various elements to test screenshot capture quality:</p>
            
            <div class="test-links">
                <a href="https://example.com" class="test-link">Example Link 1</a>
                <a href="https://github.com" class="test-link">GitHub</a>
                <a href="https://stackoverflow.com" class="test-link">Stack Overflow</a>
                <a href="https://developer.mozilla.org" class="test-link">MDN Docs</a>
            </div>
            
            <div class="image-test">
                <img src="https://picsum.photos/200/150?random=1" alt="Test Image 1" />
                <img src="https://picsum.photos/200/150?random=2" alt="Test Image 2" />
                <img src="https://picsum.photos/200/150?random=3" alt="Test Image 3" />
            </div>
        </div>
        
        <div class="test-section">
            <h2>üìä Console Monitor</h2>
            <div class="console-monitor" id="console-monitor">
                <h3>Console Output:</h3>
                <div id="console-output">Monitoring console messages...</div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üß™ Security Features Maintained</h2>
            <div class="performance-info">
                <h3>Security Improvements Still Active:</h3>
                <ul>
                    <li>No innerHTML usage (XSS prevention)</li>
                    <li>Proper event listener cleanup</li>
                    <li>URL encoding for security</li>
                    <li>Safe DOM manipulation methods</li>
                    <li>Memory leak prevention</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        // Monitor console messages for performance testing
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        const consoleOutput = document.getElementById('console-output');
        let messageCount = 0;
        
        function addConsoleMessage(type, message) {
            messageCount++;
            const timestamp = new Date().toLocaleTimeString();
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                margin: 2px 0;
                padding: 2px 5px;
                border-radius: 3px;
                font-size: 11px;
                ${type === 'error' ? 'background: rgba(239, 68, 68, 0.2); color: #ef4444;' : ''}
                ${type === 'warn' ? 'background: rgba(245, 158, 11, 0.2); color: #f59e0b;' : ''}
                ${type === 'log' ? 'background: rgba(16, 185, 129, 0.2); color: #10b981;' : ''}
            `;
            messageDiv.textContent = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            consoleOutput.appendChild(messageDiv);
            
            // Keep only last 20 messages
            if (messageCount > 20) {
                consoleOutput.removeChild(consoleOutput.children[1]); // Keep the header
            }
            
            // Auto-scroll to bottom
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addConsoleMessage('log', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addConsoleMessage('error', args.join(' '));
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addConsoleMessage('warn', args.join(' '));
        };
        
        // Performance monitoring
        let pageLoadTime = performance.now();
        
        window.addEventListener('load', () => {
            const loadTime = performance.now() - pageLoadTime;
            console.log(`Page loaded in ${loadTime.toFixed(2)}ms`);
            
            // Check for immediate logo fetching (should NOT happen)
            setTimeout(() => {
                console.log('‚úÖ Performance check: No automatic logo fetching detected on page load');
            }, 1000);
        });
        
        // Monitor extension activity
        let extensionActivityDetected = false;
        
        // Listen for extension messages (if any)
        window.addEventListener('message', (event) => {
            if (event.source === window && event.data.type === 'THE_QUICKNESS') {
                extensionActivityDetected = true;
                console.log('Extension activity detected:', event.data);
            }
        });
        
        // Performance tips
        setTimeout(() => {
            console.log('üöÄ Performance Test Ready!');
            console.log('üìã Instructions:');
            console.log('1. Click THE QUICKNESS extension icon');
            console.log('2. Verify modal opens quickly');
            console.log('3. Test PDF generation');
            console.log('4. Check for logo loading only during PDF creation');
        }, 2000);
    </script>
</body>
</html>